#!/bin/sh

. test/__test

title "Error stack overflow"

script "fn f() {
  f();
}

f();"

expect_failure "runtime error: stack overflow
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at f() in <stdin>:2
  at main() in <stdin>:5"

run
